<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Queue Management System Display</title>

  <!--- JS --->
  <script src="js/jquery-1.12.4.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/modernizr.min.js"></script>
  <script src="js/sweetalert.min.js"></script>
  <script src="js/respond.js"></script>
  <script src="js/jquery-ui.js"></script>
  <script src="js/main.js"></script>

  <!--- CSS --->
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/bootstrap-theme.min.css">
  <link rel="stylesheet" href="css/sweetalert.css">
  <link rel="stylesheet" href="css/style2.css">
  <link href="css/font-awesome.min.css" media="screen,projection" type="text/css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css?family=Bree+Serif" rel="stylesheet">
</head>

  <body>
    <div class="container-fluid">
      <div class="row">

        <!--- One Column: Serving Numbers --->
            <div class="col-sm-12 col-md-12 col-xs-12">
            <div id="Foo">
              <div class="col-sm-3 col-md-3 queueNumber">
                <div id="queueNumber0"></div>
              </div>
              <div class="col-sm-3 col-md-3 queueNumber">
                <div id="queueNumber1"></div>
              </div>
              <div class="col-sm-3 col-md-3 queueNumber">
                <div id="queueNumber2"></div>
              </div>
              <div class="col-sm-3 col-md-3 queueNumber">
                <div id="queueNumber3"></div>
              </div>
            </div>
      		</div>

          <!--- Second Column: Serving Numbers --->
              <div class="col-sm-12 col-md-12 col-xs-12">
              <div id="Foo">
                <div class="col-sm-3 col-md-3 queueNumber">
                  <div id="queueNumber4"></div>
                </div>
                <div class="col-sm-3 col-md-3 queueNumber">
                  <div id="queueNumber5"></div>
                </div>
                <div class="col-sm-3 col-md-3 queueNumber">
                  <div id="queueNumber6"></div>
                </div>
                <div class="col-sm-3 col-md-3 queueNumber">
                  <div id="queueNumber7"></div>
                </div>
              </div>
            </div>



        </div>
    </div><!--- End of Container-fluid--->

     <footer>
       <div class="row">
         <div class="col-sm-12 col-md-12 col-xs-12">
         <p class="disclaimer"> * Numbers displayed may not be called in sequence.</p>
         <p> Â© MediaOnline International 2017 </p>
       </div>
       </div>
     </footer>
  </body>

  <script>
    $(document).ready(function() {
	//Load first
	$.ajax
	   ({
		  type:'post',
		  url:'retrieve.php',
		  dataType: "json",
		  success:function(response){
			//alert(response.length);
			for(i = 0; i < response.length; i++)
			{
        $('#queueNumber'+i).text(response[i].queueNumber);
				if(response[i].status == 'TRUE')
				{
					// Make the Box flash or highlight background
           $("#queueNumber"+i).effect( "pulsate", {times:4}, 3000 );
				}
			 }
	    }
	 });

	//Load every 2minutes;
	var ajax_call =  function() {
    $('#queueNumber0').empty();
    $('#queueNumber1').empty();
    $('#queueNumber2').empty();
    $('#queueNumber3').empty();
    $('#queueNumber4').empty();
    $('#queueNumber5').empty();
	$.ajax
	   ({
		  type:'post',
		  url:'retrieve.php',
		  dataType: "json",
		  success:function(response) {
			for(i = 0; i < response.length; i++)
			{
        // Manipulate and append it to the Queue Board

        if(response[i].queueNumber != $("#Foo").children(".queueNumber").children("#queueNumber0").text() &&
            response[i].queueNumber != $("#Foo").children(".queueNumber").children("#queueNumber1").text() &&
            response[i].queueNumber != $("#Foo").children(".queueNumber").children("#queueNumber2").text() &&
            response[i].queueNumber != $("#Foo").children(".queueNumber").children("#queueNumber3").text() &&
            response[i].queueNumber != $("#Foo").children(".queueNumber").children("#queueNumber4").text() &&
            response[i].queueNumber != $("#Foo").children(".queueNumber").children("#queueNumber4").text())
        {
          $('#queueNumber'+i).text(response[i].queueNumber);
        }

				if(response[i].status == 'True')
				{
					// Make the Box flash or highlight background
           $("#queueNumber"+i).effect( "pulsate", {times:4}, 3000 );
				}
			}
	    }
	 });
	}
	 setInterval(ajax_call, 9000);
  });
  </script>
</html>
